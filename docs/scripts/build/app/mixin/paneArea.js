define(["jquery","lodash","knockout-footwork","LoadState"],function(e,t,n,r){return{_preInit:function(){this.currentSelection=n.observable().receiveFrom("PaneLinks","currentSelection"),this.paneContentMaxHeight=n.observable().receiveFrom("Pane","contentMaxHeight").extend({units:"px"}),this.loader=new r({messageStates:{busy:"Loading...",ready:"View more...",success:"View more...",fail:"Error."}}),this.entries=n.observableArray([]),this.currentPage=n.observable(1),this.description=n.observable(),this.moreUnavailable=n.observable(!1),this.moreEntriesButtonText=this.loader.message,this.initialized=n.computed(function(){return!!this.entries().length},this),this.visible=n.computed(function(){return this.currentSelection()===this.namespaceName?(this.entries().length===0&&this.loadEntries(),!0):!1},this),this.state=n.computed(function(){return{initialized:this.initialized(),visible:this.visible(),loading:this.loader.loading()}},this),this.loadEntries=function(){var n=this.currentPage();this.currentPage(n+1),this._modelOptions.params!==undefined&&this._modelOptions.params.url!==undefined&&this.loader.watch(e.ajax({url:this._modelOptions.params.url+n,dataType:"json"})).done(function(e){if(e.length){var n=this.entries();this.moreUnavailable(!1),t.each(e,function(e){n.push(new this._modelOptions.params.EntryFactory({namespace:this.namespace,entryData:e}))}.bind(this)),this.entries.valueHasMutated()}else this.moreUnavailable(!0)}.bind(this))}.bind(this)}}});