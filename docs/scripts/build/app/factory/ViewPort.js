define(["jquery","lodash","knockout-footwork"],function(e,t,n){return n.model({namespace:"ViewPort",afterCreating:function(){this.initialLoad(!1),this.isMobile()===!0&&this.config.paneCollapsed(!0)},factory:function(){this.config={transitionsEnabled:n.observable().receiveFrom("Configuration","transitionsEnabled"),paneAccentPadding:n.observable().receiveFrom("Configuration","paneAccentPadding"),paneCollapsed:n.observable().receiveFrom("Configuration","paneCollapsed"),isMobile:n.observable().receiveFrom("Configuration","isMobile"),visible:n.observable(!1).receiveFrom("Configuration","visible")},this.headerHeight=n.observable().receiveFrom("Header","height"),this.headerMinHeight=n.observable().receiveFrom("Header","minHeight"),this.resizing=n.observable(!1).extend({autoDisable:200}).broadcastAs("resizing"),this.initialLoad=n.observable(!0).broadcastAs("initialLoad"),this.scrolling=n.observable(!1).extend({autoDisable:100}).broadcastAs("scrolling"),this.scrollPosition=n.observable(0).broadcastAs("scrollPosition",!0),this.dimensions=n.observable({width:null,height:null}).extend({write:function(e,t){this.resizing(!0),e(t),this._globalChannel.publish("refreshDocSize")}.bind(this)}).broadcastAs("dimensions",!0),this.isTablet=n.observable(window.isTablet).broadcastAs("isTablet",!0),this.isMobile=this.config.isMobile.broadcastAs("isMobile",!0),this.noTransitions=n.observable(!1).broadcastAs("noTransitions",!0),this.closedOffset=n.computed(function(){return this.dimensions().width-parseInt(this.config.paneAccentPadding(),10)*2},this).broadcastAs("closedOffset"),this.openOffset=n.computed(function(){return-1*this.closedOffset()},this).broadcastAs("openOffset"),this.bottomScrollPosition=n.computed(function(){return this.scrollPosition()+this.dimensions().height},this).broadcastAs("bottomScrollPosition"),this.has3dTransforms=n.observable(window.Modernizr.csstransforms3d).broadcastAs("has3dTransforms"),this.layoutMode=n.computed(function(){return this.isMobile()?"mobile":this.isTablet()?"tablet":"desktop"},this).broadcastAs("layoutMode"),this.isSmall=n.computed(function(){return this.dimensions().width!==null?this.dimensions().width<=768:null},this).broadcastAs("isSmall"),this.logoWidth=n.observable(161).broadcastAs("logoWidth"),this.transitionsEnabled=n.computed(function(){return!this.initialLoad()&&!this.resizing()&&this.config.transitionsEnabled()&&!this.noTransitions()},this).broadcastAs("transitionsEnabled"),this.maxScrollResetPosition=n.computed(function(){return parseInt(this.headerHeight(),10)-this.headerMinHeight()},this).broadcastAs("maxScrollResetPosition"),this.scrollPosition.subscribe(function(){this.scrolling(!0)},this),this.isSmall.subscribe(function(e){this.layoutMode()==="desktop"||this.layoutMode()==="tablet"?(e||this.initialLoad()===!1)&&this.config.paneCollapsed(e):this.initialLoad()&&this.config.paneCollapsed(!0),(e||this.initialLoad()===!1)&&this.layoutMode()==="desktop"},this)}})});