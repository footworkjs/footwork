(function(e,t){typeof define=="function"&&define.amd?define(["lodash","knockout","postal"],t):typeof exports=="object"?module.exports=t(require("lodash"),require("knockout"),require("postal")):e.ko=t(_,ko,postal)})(this,function(e,t,n){var r=define,i=function(){var i={},s=i,o=undefined,u=undefined,a=undefined,f=undefined;return e.extend(i,{_:e,ko:t,postal:n}),function(){(function(e,t){typeof o=="function"&&o.amd?o(t):typeof a=="object"?u.exports=t:e.Apollo=t()})(this,function(){var e={},t,n,r,i,s=function(e,t){Object.prototype.toString.call(e)!=="[object Array]"&&(e=e.split(" "));for(var n=0;n<e.length;n++)t(e[n],n)};return document.documentElement.classList?(t=function(e,t){return e.classList.contains(t)},n=function(e,t){e.classList.add(t)},r=function(e,t){e.classList.remove(t)},i=function(e,t){e.classList.toggle(t)}):(t=function(e,t){return(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(e.className)},n=function(t,n){e.hasClass(t,n)||(t.className+=(t.className?" ":"")+n)},r=function(t,n){e.hasClass(t,n)&&(t.className=t.className.replace(new RegExp("(^|\\s)*"+n+"(\\s|$)*","g"),""))},i=function(t,n){var r=e.hasClass(t,n)?e.removeClass:e.addClass;r(t,n)}),e.hasClass=function(e,n){return t(e,n)},e.addClass=function(e,t){s(t,function(t){n(e,t)})},e.removeClass=function(e,t){s(t,function(t){r(e,t)})},e.toggleClass=function(e,t){s(t,function(t){i(e,t)})},e})}.call(i),function(){(function(e,t){typeof u=="object"&&u.exports?u.exports=t(require("lodash")):typeof o=="function"&&o.amd?o(["lodash"],function(n){return t(n,e)}):e.riveter=t(e._,e)})(this,function(e,t,n){var r=Array.prototype.slice,i=function(){var e=r.call(arguments,0);while(e.length)i.rivet(e.shift())};return i.rivet=function(e){e.hasOwnProperty("extend")||(e.extend=function(t,n){return i.extend(e,t,n)}),e.hasOwnProperty("compose")||(e.compose=function(){return i.compose.apply(this,[e].concat(r.call(arguments,0)))}),e.hasOwnProperty("inherits")||(e.inherits=function(t,n){i.inherits(e,t,n)}),e.hasOwnProperty("mixin")||(e.mixin=function(){i.mixin.apply(this,[e].concat(r.call(arguments,0)))})},i.inherits=function(t,n,r){var s,o=function(){},u=function(){n.apply(this,arguments)};return typeof t=="object"?(t.hasOwnProperty("constructor")&&(u=t.constructor),s=t):(u=t,s=t.prototype),i.rivet(u),e.defaults(u,n,r),o.prototype=n.prototype,u.prototype=new o,e.extend(u.prototype,s,{constructor:u}),u.__super=n,u.__super__=n.prototype,u},i.extend=function(e,t,n){return i.inherits(t,e,n)},i.compose=function(){var t=r.call(arguments,0),n=t.shift();i.rivet(n);var s=e.reduce(t,function(e,t){return t.hasOwnProperty("_preInit")&&e.preInit.push(t._preInit),t.hasOwnProperty("_postInit")&&e.postInit.push(t._postInit),t=t.mixin||t,e.items.push(t),e},{items:[],preInit:[],postInit:[]}),o=n.extend({constructor:function(){var t=r.call(arguments,0);e.each(s.preInit,function(e){e.apply(this,t)},this),n.prototype.constructor.apply(this,t),e.each(s.postInit,function(e){e.apply(this,t)},this)}});return i.rivet(o),e.defaults(o.prototype,e.extend.apply(null,[{}].concat(s.items))),o},i.mixin=function(){var t=r.call(arguments,0),n=t.shift();i.rivet(n),e.defaults(n.prototype,e.extend.apply(null,[{}].concat(t)))},i})}.call(i),i}();return function(t,n,r,i,s){n._footworkVersion="0.1.6";var o=n.applyBindings;n.applyBindings=function(e,t){o(e,t),typeof e.startup=="function"&&e._options!==undefined&&(e._options.startup!==!1&&e.startup(),typeof e._modelOptions.afterBinding=="function"&&e._modelOptions.afterBinding.call(e))},n.__nsStack=[],n.namespace=function(e){return r.channel(e)},n.currentNamespaceName=function(){return n.__nsStack[0]},n.currentNamespace=function(){return n.namespace(n.currentNamespaceName())},n.enterNamespaceName=function(e){n.__nsStack.unshift(e)},n.exitNamespace=function(){n.__nsStack.shift()},n.modelCount=function(){var e=t.reduce(l,function(e,t,n){return e[n]=t+1,e},{});return e.__total=t.reduce(t.values(e),function(e,t){return e+t},0),e},n.getModels=function(e){return e===undefined?u:u[e]},n.debugModels=function(e){f=e},n.refreshModels=function(){t.invoke(n.getModels(),"refreshReceived")};var u={},a=0,f=!1,l={},c=function(e,t){return l[e]===undefined?l[e]=0:l[e]++,e+(t===!0&&l[e]>0?l[e]:"")};return n.model=function(e){e=t.extend({namespace:undefined,autoIncrement:!1,mixins:undefined,params:undefined,afterBinding:function(){},factory:function(){}},e);var r={_preInit:function(r){e.namespace=c(e.namespace,e.autoIncrement),this._modelOptions=e,n.enterNamespaceName(e.namespace),this._options=t.extend({namespace:e.namespace||"namespace"+a},r),a++,this.namespace=n.namespace(this.namespace=this._options.namespace),n.currentNamespace().channel!=="/"&&(this.namespace=n.currentNamespace()),this._globalChannel=n.namespace()},mixin:{namespaceName:e.namespace,broadcastAll:function(){var e=this;return typeof this._broadcast=="object"&&t.each(this._broadcast,function(t,n){e.namespace.publish(n,t())}),t.each(this,function(n,r){t.isObject(n)===!0&&n.__isBroadcast===!0&&e.namespace.publish(r,n())}),this},refreshReceived:function(){return typeof this._receive=="object"&&this._receive.refresh!==undefined&&(t.invoke(this._receive,"refresh"),typeof this._receive.config=="object"&&t.invoke(this._receive.config,"refresh")),t.each(this,function(e,n){t.isObject(e)===!0&&e.__isReceived===!0&&e.refresh()}),t.isObject(this.config)===!0&&t.invoke(this.config,"refresh"),this},startup:function(){return this.refreshReceived().broadcastAll(),this}},_postInit:function(e){f===!0&&(u[n.currentNamespace().channel]=this),n.exitNamespace(),this.startup(),typeof this._modelOptions.afterCreating=="function"&&this._modelOptions.afterCreating.call(this)}},i=[e.factory,r];return e.mixins!==undefined&&(i=i.concat(e.mixins)),s.compose.apply(undefined,i)},n.subscribable.fn.receiveFrom=function(e,i){var s=this,o=this,u;if(t.isObject(e)===!0&&e.channel!==undefined)u=e;else{if(typeof e!="string")throw"Invalid namespace ["+typeof e+"]";u=r.channel(e)}return o=n.computed({read:s,write:function(e){u.publish("change."+i,e)}}),o.refresh=function(){u.publish("refresh."+i)},u.subscribe(i,function(e){s(e)}),o.__isReceived=!0,o},n.subscribable.fn.broadcastAs=function(e,r){var i=this,s;return t.isObject(e)===!0?r=e:typeof r=="boolean"?r={name:e,writable:r}:t.isObject(r)===!0?r=t.extend({name:e},r):r={name:e},s=r.namespace||n.currentNamespace(),r.writable&&s.subscribe("change."+r.name,function(e){i(e)}),s.subscribe("refresh."+r.name,function(){s.publish(r.name,i())}),i.subscribe(function(e){s.publish(r.name,e)}),i.__isBroadcast=!0,i},n.bindingHandlers.registerElement={preprocess:function(e){return"'"+e+"'"},init:function(e,r,i,s,o){var u=n.unwrap(r()),a,f={name:e.getAttribute("id")||e.getAttribute("name"),context:"relative"};typeof u=="string"?u=t.extend(f,{name:u}):typeof u=="object"&&(u=t.extend(f,u)),typeof s.el!="object"&&(s.el={}),s.el[u.name]=e}},n.bindingHandlers["class"]={update:function(e,t){e.__ko__previousClassValue__&&i.removeClass(e,e.__ko__previousClassValue__);var r=n.utils.unwrapObservable(t());r!==undefined&&i.addClass(e,r),e.__ko__previousClassValue__=r}},n.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}},n.extenders.throttle=function(e,t){typeof t=="number"&&(t={timeout:t,when:function(){return!0}}),e.throttleEvaluation=t.timeout;var r=null,i=n.dependentObservable({read:e,write:function(n){t.when(n)?(clearTimeout(r),r=setTimeout(function(){e(n)},t.timeout)):(clearTimeout(r),e(n))}});return i.force=function(t){clearTimeout(r),e(t)},i},n.extenders.autoDisable=function(e,t){return e.extend({delayTrigger:{delay:t||0,trigger:function(e){e(!1)}}})},n.extenders.autoEnable=function(e,t){return e.extend({delayTrigger:{delay:t||0,trigger:function(e){e(!0)}}})},n.extenders.delayTrigger=function(e,t){var r=300,i=function(){},s;typeof t=="object"?(r=!isNaN(t.delay)&&parseInt(t.delay,10)||r,i=t.trigger||i):r=!isNaN(t)&&parseInt(t,10)||r;var o=function(){clearTimeout(s),s=undefined},u=n.computed({read:e,write:function(n){e(n),s!==undefined&&o(),s=setTimeout(function(){i(e,t)}.bind(e),u.triggerDelay)}});return u.clearTrigger=o,u.triggerDelay=r,u},n.extenders.delayWrite=function(e,t){var r,i=300;return typeof t=="object"?(i=!isNaN(t.delay)&&parseInt(t.delay,10)||i,r=t.filter||function(){return!0}):i=!isNaN(t)&&parseInt(t,10)||i,n.computed({read:e,write:function(t){r(t)?(e._delayWriteTimer&&clearTimeout(this._delayWriteTimer),e._delayWriteTimer=setTimeout(function(){e(t)},i)):e(t)}})},n}(i._,i.ko,i.postal,i.Apollo,i.riveter)});