/**, * footwork.js - A solid footing for larger knockout applications., * Author: Jonathan Newman (http://staticty.pe), * Version: v0.2.0, * Url: http://footworkjs.com, * License(s): MIT, */,,(function(t,e){"function"==typeof define&&define.amd?define(["lodash","knockout"],e):"object"==typeof exports?module.exports=e(require("lodash"),require("knockout")):t.ko=e(_,ko)})(this,function(t,e){var n=window;return function(){var r={},a=r,o=void 0,i=void 0,s=void 0;return t.extend(r,{_:t,ko:e}),function(){(function(t,e){"function"==typeof o&&o.amd?o(e):"object"==typeof s?i.exports=e:t.Apollo=e()})(this,function(){"use strict";var t,e,n,r,a={},o=function(t,e){"[object Array]"!==Object.prototype.toString.call(t)&&(t=t.split(" "));for(var n=0;n<t.length;n++)e(t[n],n)};return document.documentElement.classList?(t=function(t,e){return t.classList.contains(e)},e=function(t,e){t.classList.add(e)},n=function(t,e){t.classList.remove(e)},r=function(t,e){t.classList.toggle(e)}):(t=function(t,e){return new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},e=function(t,e){a.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)},n=function(t,e){a.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(^|\\s)*"+e+"(\\s|$)*","g"),""))},r=function(t,e){var n=a.hasClass(t,e)?a.removeClass:a.addClass;n(t,e)}),a.hasClass=function(e,n){return t(e,n)},a.addClass=function(t,n){o(n,function(n){e(t,n)})},a.removeClass=function(t,e){o(e,function(e){n(t,e)})},a.toggleClass=function(t,e){o(e,function(e){r(t,e)})},a})}.call(r),function(){(function(t,e){"object"==typeof i&&i.exports?i.exports=e(require("lodash")):"function"==typeof o&&o.amd?o(["lodash"],function(n){return e(n,t)}):t.riveter=e(t._,t)})(this,function(t){var e=Array.prototype.slice,n=function(){for(var t=e.call(arguments,0);t.length;)n.rivet(t.shift())};return n.rivet=function(t){t.hasOwnProperty("extend")||(t.extend=function(e,r){return n.extend(t,e,r)}),t.hasOwnProperty("compose")||(t.compose=function(){return n.compose.apply(this,[t].concat(e.call(arguments,0)))}),t.hasOwnProperty("inherits")||(t.inherits=function(e,r){n.inherits(t,e,r)}),t.hasOwnProperty("mixin")||(t.mixin=function(){n.mixin.apply(this,[t].concat(e.call(arguments,0)))})},n.inherits=function(e,r,a){var o,i=function(){},s=function(){r.apply(this,arguments)};return"object"==typeof e?(e.hasOwnProperty("constructor")&&(s=e.constructor),o=e):(s=e,o=e.prototype),n.rivet(s),t.defaults(s,r,a),i.prototype=r.prototype,s.prototype=new i,t.extend(s.prototype,o,{constructor:s}),s.__super=r,s.__super__=r.prototype,s},n.extend=function(t,e,r){return n.inherits(e,t,r)},n.compose=function(){var r=e.call(arguments,0),a=r.shift();n.rivet(a);var o=t.reduce(r,function(t,e){return e.hasOwnProperty("_preInit")&&t.preInit.push(e._preInit),e.hasOwnProperty("_postInit")&&t.postInit.push(e._postInit),e=e.mixin||e,t.items.push(e),t},{items:[],preInit:[],postInit:[]}),i=a.extend({constructor:function(){var n=e.call(arguments,0);t.each(o.preInit,function(t){t.apply(this,n)},this),a.prototype.constructor.apply(this,n),t.each(o.postInit,function(t){t.apply(this,n)},this)}});return n.rivet(i),t.defaults(i.prototype,t.extend.apply(null,[{}].concat(o.items))),i},n.mixin=function(){var r=e.call(arguments,0),a=r.shift();n.rivet(a),t.defaults(a.prototype,t.extend.apply(null,[{}].concat(r)))},n})}.call(r),function(){(function(t,e){"object"==typeof i&&i.exports?i.exports=e():"function"==typeof o&&o.amd?o(e(t)):t.Conduit=e(t)})(this,function(){function t(t){if("function"!=typeof t.target)throw new Error("You can only make functions into Conduits.");var e={pre:t.pre||[],post:t.post||[],all:[]},n=t.context,r=t.target,a={isTarget:!0,fn:t.sync?function(){var t=Array.prototype.slice.call(arguments,0),e=r.apply(n,t);return e}:function(t){var e=Array.prototype.slice.call(arguments,1);e.splice(1,1,r.apply(n,e)),t.apply(this,e)}},o=function(){e.all=e.pre.concat([a].concat(e.post))};o();var i=function(){var r,a,o=0,i=function s(){var i,c,u=Array.prototype.slice.call(arguments,0),l=o;o+=1,l<e.all.length&&(i=e.all[l],a="target"===a?"after":i.isTarget?"target":"before",t.sync?"before"===a?(c=i.fn.apply(i.context||n,u),s.apply(this,c||u)):(r=i.fn.apply(i.context||n,u)||r,s.apply(this,[r].concat(u))):i.fn.apply(i.context||n,[s].concat(u)))};return i.apply(this,arguments),r};return i.steps=function(){return e.all},i.context=function(t){return 0===arguments.length?n:void(n=t)},i.before=function(t,n){t="function"==typeof t?{fn:t}:t,n=n||{},n.prepend?e.pre.unshift(t):e.pre.push(t),o()},i.after=function(t,n){t="function"==typeof t?{fn:t}:t,n=n||{},n.prepend?e.post.unshift(t):e.post.push(t),o()},i.clear=function(){e={pre:[],post:[],all:[]},o()},i.target=function(t){return t&&(r=t),r},i}return{Sync:function(e){return e.sync=!0,t.call(this,e)},Async:function(e){return t.call(this,e)}}})}.call(r),function(){(function(t,e){"object"==typeof i&&i.exports?i.exports=e(require("lodash"),require("conduitjs"),this):"function"==typeof o&&o.amd?o(["lodash","conduitjs"],function(n,r){return e(n,r,t)}):t.postal=e(t._,t.Conduit,t)})(this,function(t,e,n){function r(){for(;I.length;)p.unsubscribe(I.shift())}function i(t,e){return{channel:p.configuration.SYSTEM_CHANNEL,topic:"subscription."+t,data:{event:"subscription."+t,channel:e.channel,topic:e.topic}}}function s(e){return"function"==typeof e?e:e?function(n){var r=0,a=0;return t.each(e,function(t,o){r+=1,("topic"===o&&p.configuration.resolver.compare(n.topic,e.topic)||"context"===o&&e.context===(n.callback.context&&n.callback.context()||n.context)||n[o]===e[o])&&(a+=1)}),r===a}:function(){return!0}}function c(t){var e,n=new d(t.channel||this.configuration.DEFAULT_CHANNEL,t.topic,t.callback),r=this.subscriptions[n.channel];return r||(r=this.subscriptions[n.channel]={}),e=this.subscriptions[n.channel][n.topic],e||(e=this.subscriptions[n.channel][n.topic]=[]),e.push(n),n}function u(e){++S,e.channel=e.channel||this.configuration.DEFAULT_CHANNEL,e.timeStamp=new Date,t.each(this.wireTaps,function(t){t(e.data,e)}),this.subscriptions[e.channel]&&t.each(this.subscriptions[e.channel],function(t){for(var n,r=0,a=t.length;a>r;)(n=t[r++])&&v(n,e)}),0===--S&&r()}function l(){for(var t,e=0,n=Array.prototype.slice.call(arguments,0);t=n.shift();){if(S)return void I.push(t);if(this.subscriptions[t.channel]&&this.subscriptions[t.channel][t.topic]){var r=this.subscriptions[t.channel][t.topic].length;for(e=0;r>e;){if(this.subscriptions[t.channel][t.topic][e]===t){this.subscriptions[t.channel][t.topic].splice(e,1);break}e+=1}}p.publish(i("removed",t))}}var p,f=n.postal,h=function(t){this.channel=t||p.configuration.DEFAULT_CHANNEL,this.initialize()};h.prototype.initialize=function(){var t=this.publish;this.publish=new e.Async({target:t,context:this})},h.prototype.subscribe=function(){return p.subscribe({channel:this.channel,topic:1===arguments.length?arguments[0].topic:arguments[0],callback:1===arguments.length?arguments[0].callback:arguments[1]})},h.prototype.publish=function(){var t=1===arguments.length?"[object String]"===Object.prototype.toString.call(arguments[0])?{topic:arguments[0]}:arguments[0]:{topic:arguments[0],data:arguments[1]};t.channel=this.channel,p.publish(t)};var d=function(t,e,n){if(3!==arguments.length)throw new Error("You must provide a channel, topic and callback when creating a SubscriptionDefinition instance.");if(0===e.length)throw new Error("Topics cannot be empty");this.channel=t,this.topic=e,this.subscribe(n)},g=function(){var e;return function(n){var r=!1;return t.isString(n)?(r=n===e,e=n):(r=t.isEqual(n,e),e=t.clone(n)),!r}},b=function(){var e=[];return function(n){var r=!t.any(e,function(e){return t.isObject(n)||t.isArray(n)?t.isEqual(n,e):n===e});return r&&e.push(n),r}},y={withDelay:function(e){if(t.isNaN(e))throw"Milliseconds must be a number";return{name:"withDelay",fn:function(t,n,r){setTimeout(function(){t(n,r)},e)}}},defer:function(){return this.withDelay(0)},stopAfter:function(e,n){if(t.isNaN(e)||0>=e)throw"The value provided to disposeAfter (maxCalls) must be a number greater than zero.";var r=t.after(e,n);return{name:"stopAfter",fn:function(t,e,n){r(),t(e,n)}}},withThrottle:function(e){if(t.isNaN(e))throw"Milliseconds must be a number";return{name:"withThrottle",fn:t.throttle(function(t,e,n){t(e,n)},e)}},withDebounce:function(e,n){if(t.isNaN(e))throw"Milliseconds must be a number";return{name:"debounce",fn:t.debounce(function(t,e,n){t(e,n)},e,!!n)}},withConstraint:function(e){if(!t.isFunction(e))throw"Predicate constraint must be a function";return{name:"withConstraint",fn:function(t,n,r){e.call(this,n,r)&&t.call(this,n,r)}}},distinct:function(t){t=t||{};var e=function(t){return t[0]},n=t.all?new b(e):new g(e);return{name:"distinct",fn:function(t,e,r){n(e)&&t(e,r)}}}};d.prototype={after:function(){return this.callback.after.apply(this,arguments),this},before:function(){return this.callback.before.apply(this,arguments),this},"catch":function(t){var e=this.callback.target(),n=function(){try{e.apply(this,arguments)}catch(n){t(n,arguments[0])}};return this.callback.target(n),this},defer:function(){return this.callback.before(y.defer()),this},disposeAfter:function(t){var e=this;return e.callback.before(y.stopAfter(t,function(){e.unsubscribe.call(e)})),e},distinctUntilChanged:function(){return this.callback.before(y.distinct()),this},distinct:function(){return this.callback.before(y.distinct({all:!0})),this},logError:function(){if(console){var t;t=console.warn?console.warn:console.log,this.catch(t)}return this},once:function(){return this.disposeAfter(1),this},subscribe:function(t){return this.callback=new e.Async({target:t,context:this}),this},unsubscribe:function(){this.inactive||(this.inactive=!0,p.unsubscribe(this))},withConstraint:function(t){return this.callback.before(y.withConstraint(t)),this},withConstraints:function(t){for(;t.length;)this.callback.before(y.withConstraint(t.shift()));return this},withDebounce:function(t,e){return this.callback.before(y.withDebounce(t,e)),this},withDelay:function(t){return this.callback.before(y.withDelay(t)),this},withThrottle:function(t){return this.callback.before(y.withThrottle(t)),this},withContext:function(t){return this.callback.context(t),this}};var m={cache:{},regex:{},compare:function(e,n){var r,a,o,i=this.cache[n]&&this.cache[n][e];return"undefined"!=typeof i?i:((a=this.regex[e])||(r="^"+t.map(e.split("."),function(t){var e="";return o&&(e="#"!==o?"\\.\\b":"\\b"),e+="#"===t?"[\\s\\S]*":"*"===t?"[^.]+":t,o=t,e}).join("")+"$",a=this.regex[e]=new RegExp(r)),this.cache[n]=this.cache[n]||{},this.cache[n][e]=i=a.test(n),i)},reset:function(){this.cache={},this.regex={}}},v=function(t,e){!t.inactive&&p.configuration.resolver.compare(t.topic,e.topic)&&t.callback(e.data,e)},S=0,I=[];if(p={configuration:{resolver:m,DEFAULT_CHANNEL:"/",SYSTEM_CHANNEL:"postal"},subscriptions:{},wireTaps:[],ChannelDefinition:h,SubscriptionDefinition:d,channel:function(t){return new h(t)},addWireTap:function(t){var e=this;return e.wireTaps.push(t),function(){var n=e.wireTaps.indexOf(t);-1!==n&&e.wireTaps.splice(n,1)}},noConflict:function(){if("undefined"==typeof a||"undefined"!=typeof a&&"function"==typeof o&&o.amd)throw new Error("noConflict can only be used in browser clients which aren't using AMD modules");return n.postal=f,this},getSubscribersFor:function(e){var n=[];return t.each(this.subscriptions,function(r){t.each(r,function(r){n=n.concat(t.filter(r,s(e)))})}),n},reset:function(){this.unsubscribeFor(),this.configuration.resolver.reset(),this.subscriptions={}},unsubscribeFor:function(t){var e=[];this.subscriptions&&(e=this.getSubscribersFor(t),this.unsubscribe.apply(this,e))}},p.subscribe=new e.Sync({target:c,context:p}),p.publish=e.Async({target:u,context:p}),p.unsubscribe=new e.Sync({target:l,context:p}),p.subscribe.after(function(t){p.publish(i("created",t))}),p.subscriptions[p.configuration.SYSTEM_CHANNEL]={},p.linkChannels=function(e,n){var r=[],a=this;return e=t.isArray(e)?e:[e],n=t.isArray(n)?n:[n],t.each(e,function(e){var o=e.topic||"#";t.each(n,function(n){var i=n.channel||a.configuration.DEFAULT_CHANNEL;r.push(a.subscribe({channel:e.channel||a.configuration.DEFAULT_CHANNEL,topic:o,callback:function(e,r){var o=t.clone(r);o.topic=t.isFunction(n.topic)?n.topic(r.topic):n.topic||r.topic,o.channel=i,o.data=e,a.publish(o)}}))})}),r},n&&Object.prototype.hasOwnProperty.call(n,"__postalReady__")&&t.isArray(n.__postalReady__))for(;n.__postalReady__.length;)n.__postalReady__.shift().onReady(p);return p})}.call(r),function(){var t=n;(function(t,e){"use strict";var n=t.console||e,r=t.document,a=t.navigator,o=t.sessionStorage||!1,i=t.setTimeout,s=t.clearTimeout,c=t.setInterval,u=t.clearInterval,l=t.JSON,p=t.alert,f=t.History=t.History||{},h=t.history;try{o.setItem("TEST","1"),o.removeItem("TEST")}catch(d){o=!1}if(l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode,"undefined"!=typeof f.init)throw new Error("History.js Core has already been loaded...");f.init=function(){return"undefined"==typeof f.Adapter?!1:("undefined"!=typeof f.initCore&&f.initCore(),"undefined"!=typeof f.initHtml4&&f.initHtml4(),!0)},f.initCore=function(){if("undefined"!=typeof f.initCore.initialized)return!1;if(f.initCore.initialized=!0,f.options=f.options||{},f.options.hashChangeInterval=f.options.hashChangeInterval||100,f.options.safariPollInterval=f.options.safariPollInterval||500,f.options.doubleCheckInterval=f.options.doubleCheckInterval||500,f.options.disableSuid=f.options.disableSuid||!1,f.options.storeInterval=f.options.storeInterval||1e3,f.options.busyDelay=f.options.busyDelay||250,f.options.debug=f.options.debug||!1,f.options.initialTitle=f.options.initialTitle||r.title,f.options.html4Mode=f.options.html4Mode||!1,f.options.delayInit=f.options.delayInit||!1,f.intervalList=[],f.clearAllIntervals=function(){var t,e=f.intervalList;if("undefined"!=typeof e&&null!==e){for(t=0;t<e.length;t++)u(e[t]);f.intervalList=null}},f.debug=function(){f.options.debug&&f.log.apply(f,arguments)},f.log=function(){var t,e,a,o,i,s=!("undefined"==typeof n||"undefined"==typeof n.log||"undefined"==typeof n.log.apply),c=r.getElementById("log");for(s?(o=Array.prototype.slice.call(arguments),t=o.shift(),"undefined"!=typeof n.debug?n.debug.apply(n,[t,o]):n.log.apply(n,[t,o])):t="\n"+arguments[0]+"\n",e=1,a=arguments.length;a>e;++e){if(i=arguments[e],"object"==typeof i&&"undefined"!=typeof l)try{i=l.stringify(i)}catch(u){}t+="\n"+i+"\n"}return c?(c.value+=t+"\n-----\n",c.scrollTop=c.scrollHeight-c.clientHeight):s||p(t),!0},f.getInternetExplorerMajorVersion=function(){var t=f.getInternetExplorerMajorVersion.cached="undefined"!=typeof f.getInternetExplorerMajorVersion.cached?f.getInternetExplorerMajorVersion.cached:function(){for(var t=3,e=r.createElement("div"),n=e.getElementsByTagName("i");(e.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->")&&n[0];);return t>4?t:!1}();return t},f.isInternetExplorer=function(){var t=f.isInternetExplorer.cached="undefined"!=typeof f.isInternetExplorer.cached?f.isInternetExplorer.cached:Boolean(f.getInternetExplorerMajorVersion());return t},f.emulated=f.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(t.history&&t.history.pushState&&t.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(a.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(a.userAgent))),hashChange:Boolean(!("onhashchange"in t||"onhashchange"in r)||f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8)},f.enabled=!f.emulated.pushState,f.bugs={setHash:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),safariPoll:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),ieDoubleCheck:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<7)},f.isEmptyObject=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},f.cloneObject=function(t){var e,n;return t?(e=l.stringify(t),n=l.parse(e)):n={},n},f.getRootUrl=function(){var t=r.location.protocol+"//"+(r.location.hostname||r.location.host);return r.location.port&&(t+=":"+r.location.port),t+="/"},f.getBaseHref=function(){var t=r.getElementsByTagName("base"),e=null,n="";return 1===t.length&&(e=t[0],n=e.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},f.getBaseUrl=function(){var t=f.getBaseHref()||f.getBasePageUrl()||f.getRootUrl();return t},f.getPageUrl=function(){var t,e=f.getState(!1,!1),n=(e||{}).url||f.getLocationHref();return t=n.replace(/\/+$/,"").replace(/[^\/]+$/,function(t){return/\./.test(t)?t:t+"/"})},f.getBasePageUrl=function(){var t=f.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t){return/[^\/]$/.test(t)?"":t}).replace(/\/+$/,"")+"/";return t},f.getFullUrl=function(t,e){var n=t,r=t.substring(0,1);return e="undefined"==typeof e?!0:e,/[a-z]+\:\/\//.test(t)||(n="/"===r?f.getRootUrl()+t.replace(/^\/+/,""):"#"===r?f.getPageUrl().replace(/#.*/,"")+t:"?"===r?f.getPageUrl().replace(/[\?#].*/,"")+t:e?f.getBaseUrl()+t.replace(/^(\.\/)+/,""):f.getBasePageUrl()+t.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},f.getShortUrl=function(t){var e=t,n=f.getBaseUrl(),r=f.getRootUrl();return f.emulated.pushState&&(e=e.replace(n,"")),e=e.replace(r,"/"),f.isTraditionalAnchor(e)&&(e="./"+e),e=e.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},f.getLocationHref=function(t){return t=t||r,t.URL===t.location.href?t.location.href:t.location.href===decodeURIComponent(t.URL)?t.URL:t.location.hash&&decodeURIComponent(t.location.href.replace(/^[^#]+/,""))===t.location.hash?t.location.href:-1==t.URL.indexOf("#")&&-1!=t.location.href.indexOf("#")?t.location.href:t.URL||t.location.href},f.store={},f.idToState=f.idToState||{},f.stateToId=f.stateToId||{},f.urlToId=f.urlToId||{},f.storedStates=f.storedStates||[],f.savedStates=f.savedStates||[],f.normalizeStore=function(){f.store.idToState=f.store.idToState||{},f.store.urlToId=f.store.urlToId||{},f.store.stateToId=f.store.stateToId||{}},f.getState=function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!0);var n=f.getLastSavedState();return!n&&e&&(n=f.createStateObject()),t&&(n=f.cloneObject(n),n.url=n.cleanUrl||n.url),n},f.getIdByState=function(t){var e,n=f.extractId(t.url);if(!n)if(e=f.getStateString(t),"undefined"!=typeof f.stateToId[e])n=f.stateToId[e];else if("undefined"!=typeof f.store.stateToId[e])n=f.store.stateToId[e];else{for(;;)if(n=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof f.idToState[n]&&"undefined"==typeof f.store.idToState[n])break;f.stateToId[e]=n,f.idToState[n]=t}return n},f.normalizeState=function(t){var e,n;return t&&"object"==typeof t||(t={}),"undefined"!=typeof t.normalized?t:(t.data&&"object"==typeof t.data||(t.data={}),e={},e.normalized=!0,e.title=t.title||"",e.url=f.getFullUrl(t.url?t.url:f.getLocationHref()),e.hash=f.getShortUrl(e.url),e.data=f.cloneObject(t.data),e.id=f.getIdByState(e),e.cleanUrl=e.url.replace(/\??\&_suid.*/,""),e.url=e.cleanUrl,n=!f.isEmptyObject(e.data),(e.title||n)&&f.options.disableSuid!==!0&&(e.hash=f.getShortUrl(e.url).replace(/\??\&_suid.*/,""),/\?/.test(e.hash)||(e.hash+="?"),e.hash+="&_suid="+e.id),e.hashedUrl=f.getFullUrl(e.hash),(f.emulated.pushState||f.bugs.safariPoll)&&f.hasUrlDuplicate(e)&&(e.url=e.hashedUrl),e)},f.createStateObject=function(t,e,n){var r={data:t,title:e,url:n};return r=f.normalizeState(r)},f.getStateById=function(t){t=String(t);var n=f.idToState[t]||f.store.idToState[t]||e;return n},f.getStateString=function(t){var e,n,r;return e=f.normalizeState(t),n={data:e.data,title:t.title,url:t.url},r=l.stringify(n)},f.getStateId=function(t){var e,n;return e=f.normalizeState(t),n=e.id},f.getHashByState=function(t){var e,n;return e=f.normalizeState(t),n=e.hash},f.extractId=function(t){var e,n,r,a;return a=-1!=t.indexOf("#")?t.split("#")[0]:t,n=/(.*)\&_suid=([0-9]+)$/.exec(a),r=n?n[1]||t:t,e=n?String(n[2]||""):"",e||!1},f.isTraditionalAnchor=function(t){var e=!/[\/\?\.]/.test(t);return e},f.extractState=function(t,e){var n,r,a=null;return e=e||!1,n=f.extractId(t),n&&(a=f.getStateById(n)),a||(r=f.getFullUrl(t),n=f.getIdByUrl(r)||!1,n&&(a=f.getStateById(n)),a||!e||f.isTraditionalAnchor(t)||(a=f.createStateObject(null,null,r))),a},f.getIdByUrl=function(t){var n=f.urlToId[t]||f.store.urlToId[t]||e;return n},f.getLastSavedState=function(){return f.savedStates[f.savedStates.length-1]||e},f.getLastStoredState=function(){return f.storedStates[f.storedStates.length-1]||e},f.hasUrlDuplicate=function(t){var e,n=!1;return e=f.extractState(t.url),n=e&&e.id!==t.id},f.storeState=function(t){return f.urlToId[t.url]=t.id,f.storedStates.push(f.cloneObject(t)),t},f.isLastSavedState=function(t){var e,n,r,a=!1;return f.savedStates.length&&(e=t.id,n=f.getLastSavedState(),r=n.id,a=e===r),a},f.saveState=function(t){return f.isLastSavedState(t)?!1:(f.savedStates.push(f.cloneObject(t)),!0)},f.getStateByIndex=function(t){var e=null;return e="undefined"==typeof t?f.savedStates[f.savedStates.length-1]:0>t?f.savedStates[f.savedStates.length+t]:f.savedStates[t]},f.getCurrentIndex=function(){var t=null;return t=f.savedStates.length<1?0:f.savedStates.length-1},f.getHash=function(t){var e,n=f.getLocationHref(t);return e=f.getHashByUrl(n)},f.unescapeHash=function(t){var e=f.normalizeHash(t);return e=decodeURIComponent(e)},f.normalizeHash=function(t){var e=t.replace(/[^#]*#/,"").replace(/#.*/,"");return e},f.setHash=function(t,e){var n,a;return e!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.setHash,args:arguments,queue:e}),!1):(f.busy(!0),n=f.extractState(t,!0),n&&!f.emulated.pushState?f.pushState(n.data,n.title,n.url,!1):f.getHash()!==t&&(f.bugs.setHash?(a=f.getPageUrl(),f.pushState(null,null,a+"#"+t,!1)):r.location.hash=t),f)},f.escapeHash=function(e){var n=f.normalizeHash(e);return n=t.encodeURIComponent(n),f.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},f.getHashByUrl=function(t){var e=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return e=f.unescapeHash(e)},f.setTitle=function(t){var e,n=t.title;n||(e=f.getStateByIndex(0),e&&e.url===t.url&&(n=e.title||f.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=n.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(a){}return r.title=n,f},f.queues=[],f.busy=function(t){if("undefined"!=typeof t?f.busy.flag=t:"undefined"==typeof f.busy.flag&&(f.busy.flag=!1),!f.busy.flag){s(f.busy.timeout);var e=function(){var t,n,r;if(!f.busy.flag)for(t=f.queues.length-1;t>=0;--t)n=f.queues[t],0!==n.length&&(r=n.shift(),f.fireQueueItem(r),f.busy.timeout=i(e,f.options.busyDelay))};f.busy.timeout=i(e,f.options.busyDelay)}return f.busy.flag},f.busy.flag=!1,f.fireQueueItem=function(t){return t.callback.apply(t.scope||f,t.args||[])},f.pushQueue=function(t){return f.queues[t.queue||0]=f.queues[t.queue||0]||[],f.queues[t.queue||0].push(t),f},f.queue=function(t,e){return"function"==typeof t&&(t={callback:t}),"undefined"!=typeof e&&(t.queue=e),f.busy()?f.pushQueue(t):f.fireQueueItem(t),f},f.clearQueue=function(){return f.busy.flag=!1,f.queues=[],f},f.stateChanged=!1,f.doubleChecker=!1,f.doubleCheckComplete=function(){return f.stateChanged=!0,f.doubleCheckClear(),f},f.doubleCheckClear=function(){return f.doubleChecker&&(s(f.doubleChecker),f.doubleChecker=!1),f},f.doubleCheck=function(t){return f.stateChanged=!1,f.doubleCheckClear(),f.bugs.ieDoubleCheck&&(f.doubleChecker=i(function(){return f.doubleCheckClear(),f.stateChanged||t(),!0},f.options.doubleCheckInterval)),f},f.safariStatePoll=function(){var e,n=f.extractState(f.getLocationHref());if(!f.isLastSavedState(n))return e=n,e||(e=f.createStateObject()),f.Adapter.trigger(t,"popstate"),f},f.back=function(t){return t!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.back,args:arguments,queue:t}),!1):(f.busy(!0),f.doubleCheck(function(){f.back(!1)}),h.go(-1),!0)},f.forward=function(t){return t!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.forward,args:arguments,queue:t}),!1):(f.busy(!0),f.doubleCheck(function(){f.forward(!1)}),h.go(1),!0)},f.go=function(t,e){var n;if(t>0)for(n=1;t>=n;++n)f.forward(e);else{if(!(0>t))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=t;--n)f.back(e)}return f},f.emulated.pushState){var d=function(){};f.pushState=f.pushState||d,f.replaceState=f.replaceState||d}else f.onPopState=function(e,n){var r,a,o=!1,i=!1;return f.doubleCheckComplete(),(r=f.getHash())?(a=f.extractState(r||f.getLocationHref(),!0),a?f.replaceState(a.data,a.title,a.url,!1):(f.Adapter.trigger(t,"anchorchange"),f.busy(!1)),f.expectedStateId=!1,!1):(o=f.Adapter.extractEventData("state",e,n)||!1,i=o?f.getStateById(o):f.expectedStateId?f.getStateById(f.expectedStateId):f.extractState(f.getLocationHref()),i||(i=f.createStateObject(null,null,f.getLocationHref())),f.expectedStateId=!1,f.isLastSavedState(i)?(f.busy(!1),!1):(f.storeState(i),f.saveState(i),f.setTitle(i),f.Adapter.trigger(t,"statechange"),f.busy(!1),!0))},f.Adapter.bind(t,"popstate",f.onPopState),f.pushState=function(e,n,r,a){if(f.getHashByUrl(r)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(a!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.pushState,args:arguments,queue:a}),!1;f.busy(!0);var o=f.createStateObject(e,n,r);return f.isLastSavedState(o)?f.busy(!1):(f.storeState(o),f.expectedStateId=o.id,h.pushState(o.id,o.title,o.url),f.Adapter.trigger(t,"popstate")),!0},f.replaceState=function(e,n,r,a){if(f.getHashByUrl(r)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(a!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.replaceState,args:arguments,queue:a}),!1;f.busy(!0);var o=f.createStateObject(e,n,r);return f.isLastSavedState(o)?f.busy(!1):(f.storeState(o),f.expectedStateId=o.id,h.replaceState(o.id,o.title,o.url),f.Adapter.trigger(t,"popstate")),!0};if(o){try{f.store=l.parse(o.getItem("History.store"))||{}}catch(g){f.store={}}f.normalizeStore()}else f.store={},f.normalizeStore();f.Adapter.bind(t,"unload",f.clearAllIntervals),f.saveState(f.storeState(f.extractState(f.getLocationHref(),!0))),o&&(f.onUnload=function(){var t,e,n;try{t=l.parse(o.getItem("History.store"))||{}}catch(r){t={}}t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{};for(e in f.idToState)f.idToState.hasOwnProperty(e)&&(t.idToState[e]=f.idToState[e]);for(e in f.urlToId)f.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=f.urlToId[e]);for(e in f.stateToId)f.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=f.stateToId[e]);f.store=t,f.normalizeStore(),n=l.stringify(t);try{o.setItem("History.store",n)}catch(a){if(a.code!==DOMException.QUOTA_EXCEEDED_ERR)throw a;o.length&&(o.removeItem("History.store"),o.setItem("History.store",n))}},f.intervalList.push(c(f.onUnload,f.options.storeInterval)),f.Adapter.bind(t,"beforeunload",f.onUnload),f.Adapter.bind(t,"unload",f.onUnload)),f.emulated.pushState||(f.bugs.safariPoll&&f.intervalList.push(c(f.safariStatePoll,f.options.safariPollInterval)),("Apple Computer, Inc."===a.vendor||"Mozilla"===(a.appCodeName||""))&&(f.Adapter.bind(t,"hashchange",function(){f.Adapter.trigger(t,"popstate")}),f.getHash()&&f.Adapter.onDomLoad(function(){f.Adapter.trigger(t,"hashchange")})))},f.options&&f.options.delayInit||f.init()})(t)}(),function(t,e,n,r,a){e._footworkVersion="0.2.0";var o=e.applyBindings;e.applyBindings=function(t,e){o(t,e),void 0!==typeof t&&"function"==typeof t.startup&&"undefined"!=typeof t._options&&(t._options.startup!==!1&&t.startup(),"function"==typeof t._modelOptions.afterBinding&&t._modelOptions.afterBinding.call(t))},e.__nsStack=[],e.namespace=function(t){return n.channel(t)},e.currentNamespaceName=function(){return e.__nsStack[0]},e.currentNamespace=function(){return e.namespace(e.currentNamespaceName())},e.enterNamespaceName=function(t){e.__nsStack.unshift(t)},e.exitNamespace=function(){e.__nsStack.shift()},e.modelCount=function(){var e=t.reduce(c,function(t,e,n){return t[n]=e+1,t},{});return e.__total=t.reduce(t.values(e),function(t,e){return t+e},0),e},e.getModels=function(t){return void 0===t?s:s[t]};var i=!1;e.debugModels=function(t){i=t},e.refreshModels=function(){t.invoke(e.getModels(),"refreshReceived")};var s={},c={},u=function(t,e){return void 0===c[t]?c[t]=0:c[t]++,t+(e===!0&&c[t]>0?c[t]:"")};e.model=function(n){n=t.extend({namespace:void 0,autoIncrement:!1,mixins:void 0,params:void 0,afterBinding:function(){},constructor:function(){}},n);var r={_preInit:function(r){n.namespace=u(n.namespace,n.autoIncrement),this._modelOptions=n,this._options=t.extend({namespace:n.namespace||t.uniqueId("namespace")},r),e.enterNamespaceName(this._options.namespace),this.namespace=e.currentNamespace(),this._globalChannel=e.namespace()},mixin:{namespaceName:n.namespace,broadcastAll:function(){var e=this;return"object"==typeof this._broadcast&&t.each(this._broadcast,function(t,n){e.namespace.publish(n,t())}),t.each(this,function(n,r){t.isObject(n)===!0&&n.__isBroadcast===!0&&e.namespace.publish(r,n())}),this},refreshReceived:function(){return"object"==typeof this._receive&&void 0!==this._receive.refresh&&(t.invoke(this._receive,"refresh"),"object"==typeof this._receive.config&&t.invoke(this._receive.config,"refresh")),t.each(this,function(e){t.isObject(e)===!0&&e.__isReceived===!0&&e.refresh()}),t.isObject(this.config)===!0&&t.invoke(this.config,"refresh"),this},startup:function(){return this.refreshReceived().broadcastAll(),this}},_postInit:function(){i===!0&&(s[e.currentNamespace().channel]=this),e.exitNamespace(),this.startup(),"function"==typeof this._modelOptions.afterCreating&&this._modelOptions.afterCreating.call(this)}},o=[n.constructor,r];return void 0!==n.mixins&&(o=o.concat(n.mixins)),a.compose.apply(void 0,o)},e.component=function(t){if("string"!=typeof t.name)throw"Components must be provided a name (namespace).";if("string"!=typeof t.template)throw"Components must be provided a template.";t.namespace=t.name;var n=this.model(t);e.components.register(t.name,{viewModel:n,template:t.template})},e.subscribable.fn.receiveFrom=function(r,a){var o,i=this,s=this;if(t.isObject(r)===!0&&void 0!==r.channel)o=r;else{if("string"!=typeof r)throw"Invalid namespace ["+typeof r+"]";o=n.channel(r)}return s=e.computed({read:i,write:function(t){o.publish("change."+a,t)}}),s.refresh=function(){o.publish("refresh."+a)},o.subscribe(a,function(t){i(t)}),s.__isReceived=!0,s},e.subscribable.fn.broadcastAs=function(n,r){var a,o=this;return r=t.isObject(n)===!0?n:"boolean"==typeof r?{name:n,writable:r}:t.isObject(r)===!0?t.extend({name:n},r):{name:n},a=r.namespace||e.currentNamespace(),r.writable&&a.subscribe("change."+r.name,function(t){o(t)}),a.subscribe("refresh."+r.name,function(){a.publish(r.name,o())}),o.subscribe(function(t){a.publish(r.name,t)}),o.__isBroadcast=!0,o},e.bindingHandlers.registerElement={preprocess:function(t){return"'"+t+"'"},init:function(n,r,a,o){var i=e.unwrap(r()),s={name:n.getAttribute("id")||n.getAttribute("name"),context:"relative"};"string"==typeof i?i=t.extend(s,{name:i}):"object"==typeof i&&(i=t.extend(s,i)),"object"!=typeof o.el&&(o.el={}),o.el[i.name]=n}},e.bindingHandlers["class"]={update:function(t,n){t.__ko__previousClassValue__&&r.removeClass(t,t.__ko__previousClassValue__);var a=e.utils.unwrapObservable(n());void 0!==a&&r.addClass(t,a),t.__ko__previousClassValue__=a}},e.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}},e.extenders.throttle=function(t,n){"number"==typeof n&&(n={timeout:n,when:function(){return!0}}),t.throttleEvaluation=n.timeout;var r=null,a=e.dependentObservable({read:t,write:function(e){n.when(e)?(clearTimeout(r),r=setTimeout(function(){t(e)},n.timeout)):(clearTimeout(r),t(e))}});return a.force=function(e){clearTimeout(r),t(e)},a},e.extenders.autoDisable=function(t,e){return t.extend({delayTrigger:{delay:e||0,trigger:function(t){t(!1)}}})},e.extenders.autoEnable=function(t,e){return t.extend({delayTrigger:{delay:e||0,trigger:function(t){t(!0)}}})},e.extenders.delayTrigger=function(t,n){var r,a=300,o=function(){};"object"==typeof n?(a=!isNaN(n.delay)&&parseInt(n.delay,10)||a,o=n.trigger||o):a=!isNaN(n)&&parseInt(n,10)||a;
var i=function(){clearTimeout(r),r=void 0},s=e.computed({read:t,write:function(e){t(e),void 0!==r&&i(),r=setTimeout(function(){o(t,n)}.bind(t),s.triggerDelay)}});return s.clearTrigger=i,s.triggerDelay=a,s},e.extenders.delayWrite=function(t,n){var r,a=300;return"object"==typeof n?(a=!isNaN(n.delay)&&parseInt(n.delay,10)||a,r=n.filter||function(){return!0}):a=!isNaN(n)&&parseInt(n,10)||a,e.computed({read:t,write:function(e){r(e)?(t._delayWriteTimer&&clearTimeout(this._delayWriteTimer),t._delayWriteTimer=setTimeout(function(){t(e)},a)):t(e)}})};var l,p=[],f=e.router=function(e){var n=this.router;return t.isObject(e)&&t.map(e.routes,function(t){n.add(t)}),n};f.add=function(e){p.push(e),t.has(l,"valueHasMutated")&&l.valueHasMutated(),console.log("router.add",e)},f.navigationModel=function(){return"undefined"==typeof l&&(l=e.observableArray(p)),l},f.activate=t.once(t.bind(function(){},f));return e}(r._,r.ko,r.postal,r.Apollo,r.riveter)}()});